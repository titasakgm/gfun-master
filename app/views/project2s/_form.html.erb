<%= simple_form_for(@project2) do |f| %>
  <%= f.error_notification %>

  <div class="inputs">
    <%= f.input :title, :label => "ชื่อโครงการ" , :input_html => {:size => 80} %>
    <fieldset>
    <legend>เลือกกลุ่มเป้าหมาย</legend>
    <div class="help" href="#help1"></div>
    <%= f.association :targets, :as => :check_boxes, :label => false %>
    <%= f.button :submit, :value => "บันทึก" %>
    </fieldset>
    <fieldset>
    <legend>กลุ่มเปราะบาง</legend>
    <div class="help" href="#help2"></div>
    <% current_user.special_groups.each do |sp| %>
      <%= check_box_tag "project2[special_group_ids][]", sp.id, @project2.special_groups.include?(sp) %>
      <strong><%= sp.title %></strong><br/>
    <% end %>
    <br/>
    <%= f.button :submit, :value => "บันทึก" %>
    </fieldset>
    <fieldset>
    <legend>วงจรปัญหาอนามัยเจริญพันธุ์</legend>
    <div class="help" href="#help3"></div>

    <%= f.association :factors, :as => :check_boxes, :label => false %>
    <%= f.button :submit, :value => "บันทึก" %>
    </fieldset>

    <fieldset>
    <legend>ระยะเวลา</legend>
    <div class="help" href="#help4"></div>
    <%= f.input :fiscal_year, :label => "ปีงบประมาณ", :collection => 53..60 %>
    <%= f.input :cover_year, :label => "ระยะเวลาการดำเนินโครงการ (ปี)" %>
    </fieldset>

    <fieldset>
    <legend>จำนวนเป้าหมาย</legend>
    <div class="help" href="#help5"></div>

    <%= f.input :year1n, :label => "ปีที่ 1" %>
    <%= f.input :year2n, :label => "ปีที่ 2" %>
    <%= f.input :year3n, :label => "ปีที่ 3" %>
    </fieldset>
    <fieldset>
    <legend>วิธีการ</legend>
    <div class="help"></div>

    <div class="method">
    <%= f.fields_for :method1 do |m| %>
      <%= m.input :is_check, :label => false, :input_html => {:class => "check"} %> <%=  m.object.title %>
      <div class="detail">

      <%= m.association :target, :label => "กลุ่มเป้าหมาย" %>
      <%= m.input :density, :collection => 0..4, :label => "ความเข้มข้น"%>
      <%= m.input :year1_n, :label => "จำนวนเป้าหมายในปีที่ 1" %>
      <%= m.input :year2_n, :label => "จำนวนเป้าหมายในปีที่ 2" %>
      <%= m.input :year3_n, :label => "จำนวนเป้าหมายในปีที่ 3" %>
      </div>
    <% end %>
    </div>

    <div class="method">
    <%= f.fields_for :method2 do |m| %>
      <%= m.input :is_check, :label => false, :input_html => {:class => "check"} %>
      <%=  m.object.title %>
      <div class="detail">
      <%= m.association :target, :label => "กลุ่มเป้าหมาย" %>
      <div>
        <div style="float:left;padding-right:10px"><%= m.input :year1_n, :label => "จำนวนเป้าหมายในปีที่ 1" %></div>
        <div style="float:left;padding-right:10px"><%= m.input :result_year1_n, :label => "จำนวนกลุ่มเป้าหมายที่ได้ดำเนินแล้ว" %></div>
        <div style="clear:both"></div>
      </div>
      
      
      <%= m.input :year2_n, :label => "จำนวนเป้าหมายในปีที่ 2" %>
      <%= m.input :year3_n, :label => "จำนวนเป้าหมายในปีที่ 3" %>
      <%= label_tag m.object.step1_title %>
      <%= m.input :step1_dens, :collection => 0..4, :label => "ความเข้มข้น" %>
      <%= label_tag m.object.step2_title %>
      <%= m.input :step2_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      <%= label_tag m.object.step3_title %>
      <%= m.input :step3_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      <%= label_tag m.object.step4_title %>
      <%= m.input :step4_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      <%= label_tag m.object.step5_title %>
      <%= m.input :step5_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      </div>
    <% end %>
   </div>

  <div class="method">
  <%= f.fields_for :method3 do |m| %>
     <%= m.input :is_check, :label => false, :input_html => {:class => "check"} %>
      <%=  m.object.title %>
      <div class="detail">
      <%= m.association :target, :label => "กลุ่มเป้าหมาย" %>

      
      <div>
        <div style="float:left;padding-right:10px"><%= m.input :year1_n, :label => "จำนวนเป้าหมายในปีที่ 1" %></div>
        <div style="float:left;padding-right:10px"><%= m.input :result_year1_n, :label => "จำนวนกลุ่มเป้าหมายที่ได้ดำเนินแล้ว" %></div>
        <div style="clear:both"></div>
      </div>
      
      
      <%= m.input :year2_n, :label => "จำนวนเป้าหมายในปีที่ 2" %>
      <%= m.input :year3_n, :label => "จำนวนเป้าหมายในปีที่ 3" %>
      <%= label_tag m.object.step1_title %>
      <%= m.input :step1_dens, :collection => 0..4, :label => "ความเข้มข้น" %>
      <%= label_tag m.object.step2_title %>
      <%= m.input :step2_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      <%= label_tag m.object.step3_title %>
      <%= m.input :step3_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      <%= label_tag m.object.step4_title %>
      <%= m.input :step4_dens, :collection => 0..4, :label => "ความเข้มข้น"  %>
      </div>
    <% end %>

  </div>
  <div class="method">
    <%= f.fields_for :method4 do |m| %>
      <%= m.input :is_check, :label => false, :input_html => {:class => "check"} %>
      <%=  m.object.title %>
      <div class="detail">
      <%= m.association :target, :label => "กลุ่มเป้าหมาย" %>
      
      
      <div>
        <div style="float:left;padding-right:10px"><%= m.input :year1_n, :label => "จำนวนเป้าหมายในปีที่ 1" %></div>
        <div style="float:left;padding-right:10px"><%= m.input :result_year1_n, :label => "จำนวนกลุ่มเป้าหมายที่ได้ดำเนินแล้ว" %></div>
        <div style="clear:both"></div>
      </div>
      
      
      <%= m.input :year2_n, :label => "จำนวนเป้าหมายในปีที่ 2" %>
      <%= m.input :year3_n, :label => "จำนวนเป้าหมายในปีที่ 3" %>
      <%= m.input :density, :collection => 0..4, :label => "ความเข้มข้น"%>
      </div>
    <% end %>

  </div>
    </fieldset>
    <fieldset>
      <legend>ผู้นำภารกิจ</legend>
    <div class="help"></div>

      <%= f.association :leaders, :as => :check_boxes, :label => false %>
    <%= f.button :submit, :value => "บันทึก" %>
    </fieldset>
    <fieldset>
      <legend>งบประมาณ</legend>
    <div class="help"></div>

      <% count = 1 %>
       <% if @project2.new_record? %>

      <%= f.fields_for :project2_budget_srcs do |bs| %>
        <div class="block">

        <label><%= "งบประมาณปีที่ #{bs.object.nyear}" %></label>

        <%= bs.input :nyear, :as => :hidden %>
        <%= bs.association :budget_src, :label => "แหล่งงบประมาณ" %>
        <%= bs.input :budget, :label => "จำนวน(บาท)" %>
      </div>

      <% end %>
      <% else %>
        <%= f.fields_for :project2_budget_srcs, @project2.project2_budget_srcs.where(:nyear => 1)  do |bs| %>
          <div class="block">

          <label><%= "งบประมาณปีที่ #{bs.object.nyear}" %></label>

          <%= bs.input :nyear, :as => :hidden %>
          <%= bs.association :budget_src, :label => "แหล่งงบประมาณ" %>
          <%= bs.input :budget, :label => "จำนวน(บาท)" %>
          </div>

        <% end %>
        <%= f.fields_for :project2_budget_srcs, @project2.project2_budget_srcs.where(:nyear => 2) do |bs| %>
          <div class="block">

          <label><%= "งบประมาณปีที่ #{bs.object.nyear}" %></label>

          <%= bs.input :nyear, :as => :hidden %>
          <%= bs.association :budget_src, :label => "แหล่งงบประมาณ" %>
          <%= bs.input :budget, :label => "จำนวน(บาท)" %>
          </div>

        <% end %>
        <%= f.fields_for :project2_budget_srcs, @project2.project2_budget_srcs.where(:nyear => 3)  do |bs| %>
          <div class="block">

          <label><%= "งบประมาณปีที่ #{bs.object.nyear}" %></label>

          <%= bs.input :nyear, :as => :hidden %>
          <%= bs.association :budget_src, :label => "แหล่งงบประมาณ" %>
          <%= bs.input :budget, :label => "จำนวน(บาท)" %>
          </div>

        <% end %>

      <% end %>

    </fieldset>

    <%= f.input :a_budget, :label => "รวมงบประมาณปีที่ 1" %>
    <%= f.input :b_budget, :label => "รวมงบประมาณปีที่ 2" %>
    <%= f.input :c_budget, :label => "รวมงบประมาณปีที่ 3" %>

  </div>

  <div class="actions">
    <%= f.button :submit, :value => "บันทึก" %>
  </div>
<% end %>

<div id="help1" class="help_body">
กรุณาเลือกกลุ่มเป้าหมายของโครงการ โดยสามารถเลือกได้มากกว่า 1 กลุ่มเป้าหมาย
</div><!--- end of help1 -->

<div id="help2" class="help_body">
กรุณาเลือกกลุ่มเปราะบางที่เป็นกลุ่มเป้าหมายของโครงการ โดยสามารถเลือกได้มากกว่า 1 กลุ่มเป้าหมาย
</div><!--- end of help2 -->

<div id="help3" class="help_body">
กรุณาเลือกวงจรปัญหาอนามัยเจริญพันธุ์ของกลุ่มเยาวชนเป้าหมายที่โครงการต้องการแก้ไข โดยสามารถเลือกได้มากกว่า 1 วงจรปัญหา
</div><!--- end of help3 -->

<div id="help4" class="help_body">
กรณีระยะเวลาการดำเนินโครงการน้อยกว่า 1 ปี หรือไม่เต็มปี ให้ปัดเป็นเต็มปี เช่น ระยะเวลาของโครงการ 6 เดือน ให้กรอกข้อมูลเป็น 1 ปี
</div><!--- end of help4 -->

<div id="help5" class="help_body">
กรุณาระบุจำนวนกลุ่มเป้าหมายของโครงการในแต่ละปี หากทำเพียง 1 ปี ไม่ต้องกรอกข้อมูลในปีที่ 2 และปีที่ 3
</div><!--- end of help5 -->

<script type="text/javascript">
$(function(){
  $(".simple_form legend").click(function(){
    $this = $(this);
    $this.nextAll().toggle();
  });
  $(".help_body").hide();
  $(".check").click(function(){
    var $this = $(this);
    if($this.is(":checked")){
      $this.closest(".method").find(".detail").fadeIn();
    }else{
      $this.closest(".method").find(".detail").fadeOut();
    }

  });
  $(".check").each(function(){
    var $this = $(this);
    if($this.is(":checked")){
      $this.closest(".method").find(".detail").fadeIn();
    }else{
      $this.closest(".method").find(".detail").fadeOut();
    }

  });
});
</script>
<style type="text/css">
  .simple_form, .simple_form  fieldset {
    background-color:#ebf4fb;
    padding: 0.5em 1em;
  }
  .simple_form fieldset, .simple_form input, .simple_form{
    border-color:#c0dcec;
       -moz-border-radius: 20px;
    -webkit-border-radius: 20px;
    -khtml-border-radius: 20px;
    border-radius: 20px;

  }
  .simple_form input[type=submit]{
    background-color:#000;
    color:#fff;
    border:0px;
    float:right;
  }
  .simple_form input, .simple_form select{
    border:1px solid #c0dcec;
  }
  .simple_form legend{
    background-color:#3ba5f7;
     -moz-border-radius: 20px;
    -webkit-border-radius: 20px;
    -khtml-border-radius: 20px;
    border-radius: 20px;

  }
  .detail {
    border:solid 1px #999;
    padding:1em;
     -moz-border-radius: 20px;
    -webkit-border-radius: 20px;
    -khtml-border-radius: 20px;
    border-radius: 20px;
  }
  .help{
    float:right;
  }
</style>

